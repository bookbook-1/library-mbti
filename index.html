<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‚˜ë§Œì˜ ì±… ì¶”ì²œ MBTI í…ŒìŠ¤íŠ¸</title>
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <style>
        /* --- ë‹¤ê¾¸(ë‹¤ì´ì–´ë¦¬ ê¾¸ë¯¸ê¸°) & í‚¤ì¹˜ ìŠ¤íƒ€ì¼ --- */
        :root {
            --bg-color: #FFF0F5; --container-bg: #ffffff;
            --accent-pink: #FF6B81; --accent-blue: #70A1FF; --accent-yellow: #F39C12;
            --tape-color: rgba(255, 234, 167, 0.8); --border-color: #2F3542;
        }
        body {
            font-family: 'Jua', sans-serif; background-color: var(--bg-color);
            background-image: linear-gradient(rgba(0,0,0,0.05) 1px, transparent 1px), linear-gradient(90deg, rgba(0,0,0,0.05) 1px, transparent 1px);
            background-size: 40px 40px; margin: 0; padding: 20px;
            
            /* ìŠ¤í¬ë¡¤ ë¬¸ì œ í•´ê²° */
            min-height: 100vh;
            display: flex; 
            justify-content: center; 
            align-items: center; 
            text-align: center; 
            color: var(--border-color);
            
            /* ì„¸ë¡œ ìŠ¤í¬ë¡¤ í—ˆìš© */
            overflow-x: hidden; 
            position: relative;
        }
        
        .floating-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: -1; }
        .float-item { position: absolute; font-size: 6rem; opacity: 0.4; animation: float 6s ease-in-out infinite; filter: blur(1px); }
        
        /* ë¡œì¼“ ì»¨í…Œì´ë„ˆ (ìœ„ì¹˜ ì´ë™) */
        #rocket-pos-container {
            position: fixed; top: 0; left: 0;
            z-index: 9999;
            pointer-events: none;
            will-change: transform;
        }

        /* [ìˆ˜ì •ë¨] ë¡œì¼“ ë³¸ì²´ - transition ì†ì„± ì œê±° (í•‘ê·¸ë¥´ë¥´ ë„ëŠ” ë²„ê·¸ í•´ê²°) */
        #easter-rocket { 
            font-size: 6rem;
            cursor: pointer; 
            pointer-events: auto;
            /* transition: transform ... ì´ ì¤„ì„ ì‚­ì œí–ˆìŠµë‹ˆë‹¤! */
            filter: drop-shadow(2px 2px 5px rgba(0,0,0,0.2));
            display: inline-block;
        }
        #easter-rocket:hover { transform: scale(1.15); filter: drop-shadow(5px 5px 15px rgba(0,0,0,0.3)); }
        
        .barrel-roll { animation: roll 1s ease-in-out !important; }
        @keyframes roll { 0% { transform: rotate(0deg) scale(1); } 50% { transform: rotate(180deg) scale(1.2); } 100% { transform: rotate(360deg) scale(1); } }

        @keyframes float { 0% { transform: translateY(0px) rotate(0deg); } 50% { transform: translateY(-30px) rotate(10deg); } 100% { transform: translateY(0px) rotate(0deg); } }
        
        .container { 
            background: var(--container-bg); 
            max-width: 700px; width: 95%; 
            padding: 40px 30px; 
            border-radius: 30px; 
            border: 4px solid var(--border-color); 
            box-shadow: 10px 10px 0px rgba(0,0,0,0.15); 
            position: relative; 
            z-index: 1; 
            margin: 40px auto; 
        }

        .sticker-deco { position: absolute; font-size: 3.5rem; filter: drop-shadow(2px 2px 0px rgba(0,0,0,0.1)); z-index: 10; }
        h1 { font-size: 2.8rem; color: var(--accent-pink); margin-bottom: 15px; -webkit-text-stroke: 2px var(--border-color); text-shadow: 3px 3px 0px #FAD390; }
        p { font-size: 1.4rem; margin-bottom: 30px; line-height: 1.6; }
        .hidden { display: none; }
        .btn { display: block; width: 80%; margin: 20px auto; padding: 15px; border: 3px solid var(--border-color); border-radius: 50px; background-color: var(--accent-blue); color: white; font-size: 1.8rem; font-family: 'Jua', sans-serif; cursor: pointer; box-shadow: 0 6px 0 var(--border-color); transition: all 0.1s; }
        .btn:hover { transform: translateY(-3px); box-shadow: 0 9px 0 var(--border-color); background-color: #5352ed; }
        .btn:active { transform: translateY(3px); box-shadow: 0 2px 0 var(--border-color); }
        .btn-print { background-color: #2d3436; color: white; font-size: 1.4rem; padding: 12px; width: 60%; }
        .btn-print:hover { background-color: #000; }
        #q-text { font-size: 2rem; margin: 40px 0; line-height: 1.4; word-break: keep-all; background: #fff; border: 3px dashed var(--border-color); padding: 30px; border-radius: 20px; box-shadow: 5px 5px 0 rgba(0,0,0,0.05); }
        .ox-container { display: flex; gap: 20px; justify-content: center; margin-top: 30px; }
        .btn-ox { width: 110px; height: 110px; border-radius: 50%; border: 4px solid var(--border-color); font-size: 4rem; font-family: 'Jua', sans-serif; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; box-shadow: 5px 5px 0 rgba(0,0,0,0.2); }
        .btn-o { background-color: #2ed573; color: white; }
        .btn-x { background-color: #ff4757; color: white; }
        .btn-ox:hover { transform: scale(1.1) rotate(-5deg); }
        .progress-bar { width: 100%; height: 20px; background: #eee; border-radius: 10px; border: 2px solid var(--border-color); margin-bottom: 20px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--accent-yellow); width: 0%; transition: width 0.3s; }
        #mbti-type { color: var(--accent-blue); font-size: 3.5rem; -webkit-text-stroke: 2px var(--border-color); text-shadow: 4px 4px 0 #eee; margin: 10px 0; animation: pop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes pop { 0% { transform: scale(0.5); } 100% { transform: scale(1); } }
        .char-box { background: white; border: 3px solid var(--border-color); border-radius: 5px; padding: 15px; margin-bottom: 40px; display: flex; align-items: flex-start; text-align: left; box-shadow: 5px 5px 15px rgba(0,0,0,0.1); position: relative; transform: rotate(-1deg); }
        .char-box::before { content: ''; position: absolute; top: -15px; left: 50%; width: 120px; height: 35px; background-color: var(--tape-color); opacity: 0.8; box-shadow: 0 2px 5px rgba(0,0,0,0.1); transform: translateX(-50%) rotate(2deg); }
        .char-img { width: 110px; height: 150px; object-fit: cover; border: 2px solid #ddd; margin-right: 20px; background: #eee; flex-shrink: 0; padding: 5px; background: white; box-shadow: 2px 2px 5px rgba(0,0,0,0.1); }
        .char-info { flex-grow: 1; }
        .char-title { font-size: 1.4rem; color: var(--border-color); margin-bottom: 10px; border-bottom: 2px dashed #ddd; padding-bottom: 5px; }
        .char-desc { background: #f1f2f6; padding: 10px; border-radius: 10px; font-size: 1.1rem; margin-bottom: 10px;}
        .reading-tip { background: #fff4e6; padding: 10px; border-radius: 10px; font-size: 1.1rem; border: 2px solid #ffeaa7; }
        
        #book-recommendations { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
        .book-card { background: white; border: 3px solid var(--border-color); border-radius: 15px; padding: 10px; display: flex; flex-direction: column; align-items: center; box-shadow: 4px 4px 0 rgba(0,0,0,0.1); transition: 0.3s; position: relative; }
        .book-card:hover { transform: translateY(-5px) rotate(1deg); }
        .book-card img { width: 100%; aspect-ratio: 1 / 1.4; object-fit: cover; border-radius: 8px; border: 1px solid #ddd; margin-bottom: 10px; }
        .book-info h4 { margin: 0; font-size: 0.9rem; background: var(--accent-pink); color: white; padding: 3px 8px; border-radius: 20px; border: 2px solid var(--border-color); position: absolute; top: -10px; left: -5px; transform: rotate(-5deg); }
        .book-info h3 { margin: 5px 0 0 0; font-size: 1.1rem; word-break: keep-all; line-height: 1.3; }
        
        .call-num { background: #f1c40f; color: #2d3436; font-size: 0.9rem; font-weight: bold; padding: 3px 6px; border-radius: 5px; margin-top: 5px; border: 1px solid #d35400; display: inline-block; width: 90%; word-break: break-all;}
        .lib-search-btn { background: #00cec9; color: white; font-size: 0.85rem; padding: 5px 10px; border-radius: 15px; margin-top: 8px; border: none; cursor: pointer; text-decoration: none; display: inline-block; width: 85%; box-shadow: 0 2px 0 #00b894; transition: 0.2s; font-family: 'Jua'; }
        .lib-search-btn:hover { background: #00b894; transform: translateY(-2px); }
        .lib-search-btn i { margin-right: 5px; }

        div:where(.swal2-popup) {
            border: 4px solid var(--border-color) !important;
            border-radius: 20px !important;
            box-shadow: 10px 10px 0 rgba(0,0,0,0.1) !important;
            font-family: 'Jua' !important;
        }

        @media (max-width: 600px) { #book-recommendations { grid-template-columns: 1fr; } .char-box { flex-direction: column; align-items: center; text-align: center; transform: none; margin-top: 20px;} .char-box::before { display: none; } .char-img { margin: 0 0 15px 0; } .btn-ox { width: 90px; height: 90px; } .float-item { font-size: 4rem; } .btn-print { display: none; } #easter-rocket { font-size: 4rem; } }
        @media print { body { background: white !important; -webkit-print-color-adjust: exact; overflow: visible !important; } .floating-bg, .sticker-deco, .btn, #start-screen, #loading-screen, #question-screen, #rocket-pos-container, .lib-search-btn { display: none !important; } .container { box-shadow: none !important; border: none !important; width: 100% !important; max-width: 100% !important; padding: 0 !important; margin: 0 !important; } #result-screen { display: block !important; } h1, h2, h3, h4, p, div { color: black !important; text-shadow: none !important; -webkit-text-stroke: 0 !important; } .char-box { transform: none !important; box-shadow: none !important; border: 2px solid #333 !important; } .char-box::before { display: none !important; } #book-recommendations { display: grid !important; grid-template-columns: repeat(3, 1fr) !important; gap: 10px !important; } .book-card { border: 1px solid #ccc !important; box-shadow: none !important; transform: none !important; break-inside: avoid; } .book-info h4 { background: #eee !important; color: black !important; border: 1px solid #aaa !important; position: static !important; transform: none !important; display: inline-block !important; } .call-num { border: 1px solid #000 !important; background: white !important; } }
    </style>
</head>
<body>

<div class="floating-bg">
    <div class="float-item" style="top: 5%; left: 5%; animation-delay: 0s;">â˜ï¸</div>
    <div class="float-item" style="top: 15%; right: 5%; animation-delay: 1s;">â­</div>
    <div class="float-item" style="bottom: 10%; left: 8%; animation-delay: 2s;">ğŸ“š</div>
    <div class="float-item" style="top: 45%; left: -2%; animation-delay: 4s;">âœï¸</div>
    <div class="float-item" style="top: 8%; right: 35%; animation-delay: 1.5s;">ğŸŒˆ</div>
    <div class="float-item" style="bottom: 15%; right: 8%; font-size: 5rem; animation-delay: 3s;">ğŸ“–</div>
</div>

<div id="rocket-pos-container">
    <div id="easter-rocket" onclick="triggerEasterEgg()">ğŸš€</div>
</div>

<div class="container">
    <div class="sticker-deco" style="top: -25px; left: -25px; transform: rotate(-15deg);">ğŸ€</div>
    <div class="sticker-deco" style="bottom: -15px; right: -15px; transform: rotate(10deg);">ğŸ§¸</div>

    <div id="start-screen">
        <div style="font-size: 5rem; margin-bottom: 20px;">ğŸ«ğŸ“šğŸ”</div>
        <h1>ë‚˜ë§Œì˜<br>ë…ì„œ ì„±í–¥ ì°¾ê¸°!</h1>
        <p>ë‚˜ëŠ” ì–´ë–¤ ì±…ì„ ì¢‹ì•„í• ê¹Œ?<br>ì¬ë¯¸ìˆëŠ” í€´ì¦ˆë¡œ ì•Œì•„ë³´ì!</p>
        <button class="btn" onclick="startTest()">ì‹œì‘í•˜ê¸° â–¶</button>
    </div>

    <div id="loading-screen" class="hidden">
        <p style="font-size: 5rem; animation: spin 2s infinite linear;">ğŸ¡</p>
        <p style="font-size: 1.5rem; font-weight: bold; color: var(--accent-blue);">ì—´ì‹¬íˆ ë¶„ì„ ì¤‘...</p>
        <style>@keyframes spin { 100% { transform: rotate(360deg); } }</style>
    </div>

    <div id="question-screen" class="hidden">
        <div class="progress-bar"><div id="p-fill" class="progress-fill"></div></div>
        <h2 id="q-progress">1 / 12</h2>
        <h3 id="q-text">ì§ˆë¬¸ ë‚´ìš©</h3>
        <div class="ox-container">
            <button class="btn-ox btn-o" onclick="selectAnswer('O')">O</button>
            <button class="btn-ox btn-x" onclick="selectAnswer('X')">X</button>
        </div>
    </div>

    <div id="result-screen" class="hidden">
        <div style="font-size: 1.2rem; background: var(--accent-yellow); display: inline-block; padding: 5px 15px; border-radius: 20px; border: 2px solid black; color: white; margin-bottom: 10px;">âœ¨ ë¶„ì„ ì™„ë£Œ! âœ¨</div>
        <h2 style="margin:0;">ë‚˜ì˜ ë…ì„œ ìœ í˜•ì€?</h2>
        <h1 id="mbti-type">TYPE</h1>
        
        <div class="char-box">
            <img id="char-img" class="char-img" src="" alt="ìºë¦­í„°">
            <div class="char-info">
                <div id="char-title" class="char-title"></div>
                <div id="mbti-desc" class="char-desc"></div>
                <div style="font-size: 0.9rem; color: #aaa; margin-top:5px;">ğŸ’¡ ì±…ê³¼ ë” ì¹œí•´ì§€ëŠ” ë°©ë²•</div>
                <div id="reading-tip" class="reading-tip"></div>
            </div>
        </div>

        <p style="font-size: 1.3rem; font-weight: bold; color: var(--accent-pink);">ğŸ ì´ëŸ° ì±…ì„ ì¶”ì²œí•´ìš”!</p>
        <div id="book-recommendations"></div>
        
        <button class="btn btn-print" onclick="window.print()"><i class="fas fa-print"></i> ê²°ê³¼ ì¸ì‡„í•˜ê¸°</button>
        <button class="btn" style="background-color: var(--accent-pink); margin-top: 15px;" onclick="location.reload()">ë‹¤ì‹œ í•˜ê¸° ğŸ”„</button>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>

<script>
    const QUESTIONS_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSr94F8Ac7dccR7pp4QhighoUgUjy_ADV-5fC6RqGgkpmKDjZHW5zoJ_Kc6lrGg2GRwnOVgj7F31cc0/pub?gid=0&single=true&output=csv";
    const RESULTS_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSr94F8Ac7dccR7pp4QhighoUgUjy_ADV-5fC6RqGgkpmKDjZHW5zoJ_Kc6lrGg2GRwnOVgj7F31cc0/pub?gid=950326899&single=true&output=csv";

    let questions = [];
    let resultsData = [];
    let currentQIndex = 0;
    let scores = { E:0, I:0, S:0, N:0, T:0, F:0, J:0, P:0 };
    let easterEggMsg = "ë³´ë¬¼ì„ ì°¾ì•˜êµ°ìš”!"; 
    let libraryUrl = ""; 
    let isDataLoaded = false; 

    // ë¶€ë“œëŸ¬ìš´ ë¡œì¼“ ì›€ì§ì„ ë³€ìˆ˜
    let rX = window.innerWidth - 150, rY = window.innerHeight - 150;
    let vX = -1.2, vY = -0.8; 
    const posContainer = document.getElementById('rocket-pos-container');
    const rocketBody = document.getElementById('easter-rocket');
    let isRocketPaused = false;

    async function fetchData() {
        const bustCache = "&t=" + Date.now();
        try {
            const [qData, rData] = await Promise.all([
                fetch(QUESTIONS_URL + bustCache).then(res => res.text()),
                fetch(RESULTS_URL + bustCache).then(res => res.text())
            ]);
            questions = Papa.parse(qData, { header: true, skipEmptyLines: true }).data;
            resultsData = Papa.parse(rData, { header: true, skipEmptyLines: true }).data;
            
            if(!questions.length) throw new Error("ë°ì´í„° ì—†ìŒ");
            
            if(questions[0]['ì´ìŠ¤í„°ì—ê·¸']) easterEggMsg = questions[0]['ì´ìŠ¤í„°ì—ê·¸'];
            if(questions[0]['ë„ì„œê´€ë§í¬']) libraryUrl = questions[0]['ë„ì„œê´€ë§í¬'];
            
            isDataLoaded = true; 

        } catch (error) { alert("ì˜¤ë¥˜: " + error.message); }
    }

    function startTest() { 
        if (!isDataLoaded) {
            alert("ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”!");
            return;
        }
        document.getElementById('start-screen').classList.add('hidden');
        document.getElementById('question-screen').classList.remove('hidden');
        showQuestion();
    }

    fetchData();

    function animateRocket() {
        if(isRocketPaused) {
            requestAnimationFrame(animateRocket);
            return;
        }

        rX += vX;
        rY += vY;

        if (rX <= 0 || rX >= window.innerWidth - 100) {
            vX *= -1;
            rX = Math.max(0, Math.min(rX, window.innerWidth - 100));
        }
        if (rY <= 0 || rY >= window.innerHeight - 100) {
            vY *= -1;
            rY = Math.max(0, Math.min(rY, window.innerHeight - 100));
        }

        vX += (Math.random() - 0.5) * 0.05; 
        vY += (Math.random() - 0.5) * 0.05;

        const maxSpeed = 2.5;
        const minSpeed = 0.5;
        const currentSpeed = Math.sqrt(vX*vX + vY*vY);
        
        if (currentSpeed > maxSpeed) { vX *= 0.95; vY *= 0.95; }
        if (currentSpeed < minSpeed) { vX *= 1.05; vY *= 1.05; }

        const angle = Math.atan2(vY, vX) * (180 / Math.PI) + 45;

        posContainer.style.transform = `translate3d(${rX}px, ${rY}px, 0)`;
        rocketBody.style.transform = `rotate(${angle}deg)`;

        requestAnimationFrame(animateRocket);
    }

    animateRocket();

    window.addEventListener('resize', () => {
        rX = Math.min(rX, window.innerWidth - 100);
        rY = Math.min(rY, window.innerHeight - 100);
    });

    function triggerEasterEgg() {
        isRocketPaused = true; 
        
        rocketBody.classList.add('barrel-roll');
        
        var duration = 3 * 1000;
        var animationEnd = Date.now() + duration;
        var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 9999 };
        function randomInRange(min, max) { return Math.random() * (max - min) + min; }
        var interval = setInterval(function() {
            var timeLeft = animationEnd - Date.now();
            if (timeLeft <= 0) { return clearInterval(interval); }
            var particleCount = 50 * (timeLeft / duration);
            confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.1, 0.9), y: Math.random() - 0.2 } }));
        }, 250);

        Swal.fire({
            title: 'ğŸ‰ ë³´ë¬¼ì°¾ê¸° ì„±ê³µ! ğŸ‰',
            text: easterEggMsg,
            icon: 'success',
            confirmButtonText: 'ë‹«ê¸°',
            confirmButtonColor: '#FF6B81',
            background: '#fff',
            backdrop: `rgba(0,0,123,0.1)` 
        }).then(() => {
            rocketBody.classList.remove('barrel-roll');
            isRocketPaused = false;
        });
    }

    function showQuestion() {
        const q = questions[currentQIndex];
        document.getElementById('q-progress').innerText = `Q${currentQIndex + 1}`;
        document.getElementById('q-text').innerText = q['ì§ˆë¬¸ë‚´ìš©'];
        const percent = ((currentQIndex) / questions.length) * 100;
        document.getElementById('p-fill').style.width = `${percent}%`;
    }

    function selectAnswer(choice) {
        const q = questions[currentQIndex];
        const typeToAdd = choice === 'O' ? q['Oì ìˆ˜'] : q['Xì ìˆ˜'];
        if(typeToAdd && scores[typeToAdd.trim()] !== undefined) scores[typeToAdd.trim()]++;
        
        currentQIndex++;
        document.getElementById('p-fill').style.width = `${(currentQIndex / questions.length) * 100}%`;
        
        if (currentQIndex < questions.length) {
            setTimeout(showQuestion, 200);
        } else {
            setTimeout(calculateResult, 200);
        }
    }

    function calculateResult() {
        const mbti = [
            scores.E >= scores.I ? 'E' : 'I',
            scores.S >= scores.N ? 'S' : 'N',
            scores.T >= scores.F ? 'T' : 'F',
            scores.J >= scores.P ? 'J' : 'P'
        ].join('');

        const myResult = resultsData.find(r => r.MBTI === mbti);
        
        document.getElementById('question-screen').classList.add('hidden');
        document.getElementById('result-screen').classList.remove('hidden');
        
        var duration = 3 * 1000;
        var animationEnd = Date.now() + duration;
        var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 999 };
        function randomInRange(min, max) { return Math.random() * (max - min) + min; }
        var interval = setInterval(function() {
            var timeLeft = animationEnd - Date.now();
            if (timeLeft <= 0) { return clearInterval(interval); }
            var particleCount = 50 * (timeLeft / duration);
            confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } }));
            confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } }));
        }, 250);

        if (myResult) {
            document.getElementById('mbti-type').innerText = mbti;
            
            const charImgSrc = myResult['ìºë¦­í„°ì´ë¯¸ì§€'] && myResult['ìºë¦­í„°ì´ë¯¸ì§€'].startsWith('http') ? myResult['ìºë¦­í„°ì´ë¯¸ì§€'] : 'https://via.placeholder.com/150';
            document.getElementById('char-img').src = charImgSrc;
            document.getElementById('char-title').innerHTML = `<span style="background:#ff7675; color:white; padding:2px 8px; border-radius:10px; font-size:0.8rem; margin-right:5px;">ë‚˜ì™€ ë‹®ì€ ì±… ì† ì£¼ì¸ê³µ</span> <b>${myResult['ìºë¦­í„°ì´ë¦„']}</b> (${myResult['ìºë¦­í„°ì±…ì œëª©']})`;
            document.getElementById('mbti-desc').innerText = myResult['ìºë¦­í„°ì„¤ëª…'];
            document.getElementById('reading-tip').innerText = myResult['ë…ì„œíŒ'];

            const container = document.getElementById('book-recommendations');
            container.innerHTML = '';
            
            const books = [
                { label: myResult['ë¼ë²¨1'], title: myResult['ë„ì„œëª…1'], img: myResult['í‘œì§€1'], callNum: myResult['ì²­êµ¬ê¸°í˜¸1'], isbn: myResult['ë„ì„œISBN1'] },
                { label: myResult['ë¼ë²¨2'], title: myResult['ë„ì„œëª…2'], img: myResult['í‘œì§€2'], callNum: myResult['ì²­êµ¬ê¸°í˜¸2'], isbn: myResult['ë„ì„œISBN2'] },
                { label: myResult['ë¼ë²¨3'], title: myResult['ë„ì„œëª…3'], img: myResult['í‘œì§€3'], callNum: myResult['ì²­êµ¬ê¸°í˜¸3'], isbn: myResult['ë„ì„œISBN3'] }
            ];

            books.forEach(book => {
                const imgSrc = book.img && book.img.startsWith('http') ? book.img : 'https://via.placeholder.com/150x200?text=No+Img';
                let extraInfoHtml = '';
                if(book.callNum) {
                    extraInfoHtml += `<div class="call-num">ğŸ“š ${book.callNum}</div>`;
                }
                if(libraryUrl && book.isbn) {
                    const searchLink = libraryUrl + book.isbn;
                    extraInfoHtml += `<a href="${searchLink}" target="_blank" class="lib-search-btn"><i class="fas fa-search"></i> ë„ì„œê´€ì—ì„œ ì°¾ê¸°</a>`;
                }

                container.innerHTML += `
                    <div class="book-card">
                        <div class="book-info"><h4>${book.label}</h4></div>
                        <img src="${imgSrc}" alt="${book.title}">
                        <div class="book-info"><h3>${book.title}</h3></div>
                        ${extraInfoHtml}
                    </div>
                `;
            });
        }
    }
</script>
</body>
</html>
